{% extends "_base.html" %}
{% block bodycontent %}
<div id="loggedIn">
    
    <div id="header">
        <div id="nav">
            <div id="presence">
                {% ifnotequal logoutURL None %}
                    <a href="{{ logoutURL }}">Logout</a>
                {% endifnotequal %}
                <a href="/settings" id="settingsLink">Settings</a>
                <a href="/info" id="infoLink">Info</a>
                <splan id="user">{{ profile.email }}</splan>
            </div>
            <a href="/" id="logo">
                <img src="/static/logoMain.png" width="88" height="50" alt="SNPTZ">
            </a>
        </div>
    </div>
    
    <!-- Empty div for the background -->
    <div id="bg"></div>

    <!-- Empty div for notifications -->
    <div id="notifications">Test</div>
    
    <div id="main" {% ifnotequal current_page "main" %} style="display:none;" {% endifnotequal %}>
        
        <div id="thisWeek">
            <div class="timeStamp">
                <em>This week</em> {{ profile.this_weeks_taskweek.created|date:"M j" }} -
            </div>
            <div class="plans">
                <ul>
                    {% for t in profile.this_weeks_taskweek.optimistic %}
                        <li>{{ t }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        
        <div id="history">
            
            <div class="weekChunk clearfix">
                <div class="plans">
                    <div class="timeStamp">
                        Week of <em>{{ profile.last_past_taskweek.created|date:"M j" }}</em>
                    </div>
                    <ul>
                        {% for t in profile.last_past_taskweek.optimistic %}
                            <li>{{ t }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="review">
                    <div class="timeStamp">
                        How'd it go?
                    </div>
                    <ul>
                        {% for t in profile.last_past_taskweek.realistic %}
                            <li>{{ t }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        
            {% for tw in profile.all_other_past_taskweeks %}
                <div class="weekChunk clearfix">
                    <div class="plans">
                        <div class="timeStamp">
                            Week of <em>{{ tw.created|date:"M j" }}</em>
                        </div>
                        <ul>
                            {% for t in tw.optimistic %}
                                <li>{{ t }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="review">
                        <div class="timeStamp">
                            How'd it go?
                        </div>
                        <ul>
                            {% for t in tw.realistic %}
                                <li>{{ t }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% endfor %}
            
        </div>
        {% if teams %}
            <div id="sidebar">
            {% for team in teams %}
                    <div class="team" id="team-{{ team.name }}">
                    <h3>esteemed colleages from <a href="/team/{{team.slug}}">{{ team.name }}</a></h3>
                    <ul>
                    {% for member in team.membership_set %}
                        {% ifnotequal member.profile.name profile.name %}
                            <li>{{ member.profile.name }}</li>
                        {% endifnotequal %}
                    {% endfor %}
                    </ul>
                    </div>
            {% endfor %}
            </div>
        {% endif %}
    </div>
    
    <div id="info" class="subPage" {% ifnotequal current_page "info" %} style="display:none;" {% endifnotequal %}>
        <h1>Info</h1>
        Built by Ted and Evan
    </div>
    
    <div id="team" class="subPage" {% ifnotequal current_page "team" %} style="display:none;" {% endifnotequal %}>
        {% if team %}
            <h1>{{ team.name }}</h1>
                <em>Keeping esteemed colleagues in the loop since {{ team.created|date:"M j" }}</em>
            <ul>
            {% for member in team.membership_set %}
                {% ifnotequal member.profile.name profile.name %}
                    <li>
                        <div>
                        {{ member.profile.name }}
                        {{ member.profile.this_weeks_taskweek.optimistic_as_str }}
                        </div>
                    </li>
                {% endifnotequal %}
            {% endfor %}
            </ul>
        {% endif %}
    </div>
    
    <div id="settings" class="subPage" {% ifnotequal current_page "settings" %} style="display:none;" {% endifnotequal %}>
        <h1>Settings</h1>
        <form action="/settings" method="post">

            <div>Email</div>
            <div>{{ profile.email }}</div>
            <div>First name</div>
            <div><input type="text" name="firstname" id="firstname"
                {% ifnotequal profile.first_name None %}
                    value="{{ profile.first_name }}"
                {% endifnotequal %}/></div>
            <div>Last name</div>
            <div><input type="text" name="lastname"  id="lastname"
                {% ifnotequal profile.last_name None %}
                    value="{{ profile.last_name }}"
                {% endifnotequal %}/></div>
            <div>
                <input type="checkbox" name="weeklyEmailsToggle" id="weeklyEmailsToggle"
                {% if profile.weekly_email %}
                    checked="yes"
                {% endif %} />
                <label for="weeklyEmailsToggle">Subscribe to weekly reminder emails</label>
            </div>
            <div>
                <select name='timezone'>
                  <option {% ifequal profile.timezone "est"%} selected {% endifequal %} value="est">(GMT-5:00) Eastern Time</option>
                  <option {% ifequal profile.timezone "cst"%} selected {% endifequal %} value="cst">(GMT-6:00) Central Time</option>
                  <option {% ifequal profile.timezone "mst"%} selected {% endifequal %} value="mst">(GMT-7:00) Mountain Time</option>
                  <option {% ifequal profile.timezone "pst"%} selected {% endifequal %} value="pst">(GMT-8:00) Pacific Time</option>
                </select>
            </div>
            <div><input type="submit" id="settingsSubmit" value="Save settings"></div>
        </form>
        
        <form action="/settings" method="post">
        <h1>Esteemed colleagues</h1>

            <div>My teams</div>
            {% for team in memberships_teams %}
                <div>
                    <label for="team-{{team.key}}">{{team.name}}</label>
                    <input type="checkbox" name="team-{{team.key}}" checked="yes"/>
                </div>
            {% endfor %}

            <div>Other teams</div>
            {% for team in other_teams %}
                <div>
                    <label for="team-{{team.key}}">{{team.name}}</label>
                    <input type="checkbox" name="team-{{team.key}}"/>
                </div>
            {% endfor %}
            <div>
                <label for="newteamname">Create new team</label>
                <input type="text" name="newteamname" value=""/>
            </div>
            <div><input type="submit" value="Edit teams"></div>
            
        </form>

        <a href="#">Delete account (this cannot be undone)</a>
        <br/>

    </div>
</div>
{% endblock %}
